{{ $name := .Get 0 }}
{{ $source := .Get 1 }}
{{ $target := strings.ReplaceRE ".typ$" ".pdf" $source }}
{{ $server := .Site.Params.typst.server }}
{{ $url := printf "http://localhost:5000?file=%s" $server (urlize $source) }}

{{ with resources.GetRemote $url }}
{{ with resources.Copy $target . }}
<span class="typst">[[<a href="{{ .Permalink }}">{{ $name }}</a>]]</span>
{{ end }}
{{ end }}
