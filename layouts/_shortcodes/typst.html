{{ $name := .Get 0 }}
{{ $source := .Get 1 }}
{{ $target := strings.ReplaceRE ".typ$" ".pdf" $source }}
{{ $url := printf "http://127.0.0.1:5000?file=%s" (urlize $source) }}

{{ with resources.GetRemote $url }}
{{ with resources.Copy $target . }}
<span class="typst">[[<a href="{{ .Permalink }}">{{ $name }}</a>]]</span>
{{ end }}
{{ end }}
